---
title: "<center>Ward’s Method of Cluster Analysis and Principal Components</center><hr>"
author: "<center>Granger Moch, Sam Eckhardt</center>" 
date: "<center>March 31, 2015</center> <hr>"
output: 
  html_document:
    toc: true
    number_sections: FALSE 
    theme: flatly 
    highlight: zenburn
---

#Load Packages
```{r, message=FALSE, warning=FALSE}
library(Rcmdr)
library(car)
library(RcmdrMisc)
library(BCA)
library(knitr)
library(rgl)
```

```{r}
knit_hooks$set(webgl = hook_webgl)
```
#Load Athletic Dataset
```{r}
data(Athletic, package="BCA")
```

#Explore Dataset Structure
```{r}
str(Athletic)
```

#Create Ward's Method Clustering Solution
```{r}
WardsAthletic <- hclust(dist(model.matrix(~-1 + Attnd+Fem+Finan+Grad+Teams+Violat+Win, 
                                          Athletic))^2 , method= "ward")
```

##Plot Dendrogram
```{r}
plot(WardsAthletic, main= "Cluster Dendrogram for Solution WardsAthletic", xlab= 
       "Observation Number in Data Set Athletic", 
     sub="Method=ward; Distance=squared-euclidian")
```

##Summarize Solution
###Cluster Size
```{r}
summary(as.factor(cutree(WardsAthletic, k = 4)))
```
<center>This shows the number of individuals assigned to each cluster.</center>

#Cluster Centroids
```{r}
by(model.matrix(~-1 + Attnd + Fem + Finan + Grad + Teams + Violat + Win, Athletic), 
   as.factor(cutree(WardsAthletic, k = 4)), colMeans) # Cluster Centroids
```

<center>Most important variables as identified by each cluster:

Cluster 1: Winning
Cluster 2: Graduation Rates
Cluster 3: NCAA Rule Violations
Cluster 4: Financial Success </center>


#Add Variable to Identify Clusters 
```{r}
Athletic$Wards4 <- assignCluster(model.matrix(~-1 + Attnd + Fem + Finan + Grad + Teams 
                                              + Violat + Win, Athletic), Athletic, cutree(WardsAthletic, k = 4))
```
<center>This variable is created so that we can also compare cluster means graphically.</center>

##Plot of Means
```{r}
with(Athletic, plotMeans(Grad, Wards4, error.bars="conf.int", level=0.95))
```

This means plot shows that cluster 2 cares most about “Grad”.

#2D Bi-Plot of Clusters
```{r}
bpCent(prcomp(model.matrix(~-1 + Attnd + Fem + Finan + Grad + Teams + Violat + Win, 
                           Athletic)), cutree(WardsAthletic, k = 4), data.pts = TRUE, centroids = TRUE, xlabs = 
         as.character(cutree(WardsAthletic, k = 4)))
```

#3D Bi Plot of Clusters
```{r}
bpCent3d(prcomp(model.matrix(~-1 + Attnd + Fem + Finan + Grad + Teams + Violat + Win, 
                             Athletic)), cutree(WardsAthletic, k = 4), data.pts = TRUE, centroids = TRUE, xlabs = 
           as.character(cutree(WardsAthletic, k = 4)))
```

